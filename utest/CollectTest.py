import unittest
from core.collect import *
import arrow

order_timelines_data = [{'accept': 0.07, 'actual_delivery_time': 22.93, 'actual_showup_time': 2.1, 'actual_total_time': 24.65, 'actual_work_time': 24.57, 'area_id': 31, 'child_area_id': 0, 'default_service_type': 2, 'delivery_sign': 24.38, 'id': 2020042271242260, 'position_type_id': 2, 'region': 'HK', 'showup': 0.95, 'showup_bluetooth': 0.0, 'showup_gps': 0.95, 'showup_manual': 0.0, 'tasker_id': 852000828, 'time': '20200422141714', 'total': 26.1, 'user_id': 100000109, 'work': 26.03},
                        {'accept': 4.0, 'actual_delivery_time': 11.15, 'actual_showup_time': 7.73, 'actual_total_time': 27.45, 'actual_work_time': 23.45, 'area_id': 10, 'child_area_id': 0, 'default_service_type': 2, 'delivery_sign': 15.35, 'id': 2020042275639687, 'position_type_id': 2, 'region': 'HK', 'showup': 4.65, 'showup_bluetooth': 0.0, 'showup_gps': 4.65, 'showup_manual': 0.0, 'tasker_id': 8970, 'time': '20200422141713', 'total': 31.65, 'user_id': 100000037, 'work': 27.65},
                        {'accept': 13.7, 'actual_delivery_time': 10.53, 'actual_showup_time': 12.75, 'actual_total_time': 37.67, 'actual_work_time': 23.97, 'area_id': 36, 'child_area_id': 187, 'default_service_type': 2, 'delivery_sign': 11.9, 'id': 2020042268286952, 'position_type_id': 10, 'region': 'HK', 'showup': 12.82, 'showup_bluetooth': 0.0, 'showup_gps': 12.82, 'showup_manual': 0.0, 'tasker_id': 852003658, 'time': '20200422141632', 'total': 39.03, 'user_id': 100000142, 'work': 25.33}]

tasker_realtime_info_data = [{'accuracy': 37.25, 'id': 100002055, 'latitude': 22.4134731293, 'longitude': 113.9826812744, 'time': '20200422140800'}, {'accuracy': 14.82, 'id': 100002080, 'latitude': 22.3253326416, 'longitude': 114.1585388184, 'time': '20200422140800'}, {'accuracy': 12.13, 'id': 100002114, 'latitude': 22.3625488281, 'longitude': 114.172164917, 'time': '20200422140800'}]


tasker_order_num_data = [{'id': 100005565, 'order_id': [2020042281436137, 2020042297911725], 'order_num': 2, 'position_type_id': 2, 'region': 'HK', 'time': '20200422160600'},
{'id': 100000034, 'order_id': [2020042211067393], 'order_num': 1, 'position_type_id': 2, 'region': 'HK', 'time': '20200422160600'},
{'id': 100007763, 'order_id': [2020042221255978], 'order_num': 1, 'position_type_id': 2, 'region': 'HK', 'time': '20200422160600'},
                         ]
order_405_data = {'id': {0: 2020042281436137, 1: 2020042219548702, 2: 2020042211067393, 3: 2020042221255978, 4: 2020042210701216, 5: 2020042261111336}, 'tasker_id': {0: 100005565, 1: 100000328, 2: 100000034, 3: 100007763, 4: 852010787, 5: 9058}, 'order_405_time': {0: 1587543095, 1: 1587543033, 2: 1587543552, 3: 1587543323, 4: 1587543817, 5: 1587543903}, '405_before_10': {0: 1587542495, 1: 1587542433, 2: 1587542952, 3: 1587542723, 4: 1587543217, 5: 1587543303}, '405_after_10': {0: 1587543695, 1: 1587543633, 2: 1587544152, 3: 1587543923, 4: 1587544417, 5: 1587544503}}

area_busy_index_data = [{'extra_require_biker': 5, 'extra_require_walker': 0, 'id': 2, 'time': '20200422161700'}, {'extra_require_biker': 2, 'extra_require_walker': 0, 'id': 3, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 4, 'time': '20200422161700'}, {'extra_require_biker': 2, 'extra_require_walker': 0, 'id': 7, 'time': '20200422161700'}, {'extra_require_biker': 3, 'extra_require_walker': 0, 'id': 8, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 10, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 11, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 16, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 17, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 18, 'time': '20200422161700'}, {'extra_require_biker': 3, 'extra_require_walker': 0, 'id': 20, 'time': '20200422161700'}, {'extra_require_biker': 2, 'extra_require_walker': 0, 'id': 21, 'time': '20200422161700'}, {'extra_require_biker': 3, 'extra_require_walker': 0, 'id': 22, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 23, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 24, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 27, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 28, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 29, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 30, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 31, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 33, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 34, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 35, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 36, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 37, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 38, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 39, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 40, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 41, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 42, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 146, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 149, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 159, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 160, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 0, 'id': 161, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 167, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 168, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 178, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 183, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 188, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 191, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 193, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 194, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 195, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 206, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 213, 'time': '20200422161700'}, {'extra_require_biker': 2, 'extra_require_walker': 0, 'id': 216, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 217, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 231, 'time': '20200422161700'}, {'extra_require_biker': 0, 'extra_require_walker': 0, 'id': 278, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 282, 'time': '20200422161700'}, {'extra_require_biker': 2, 'extra_require_walker': 2, 'id': 283, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 310, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 329, 'time': '20200422161700'}, {'extra_require_biker': 1, 'extra_require_walker': 1, 'id': 339, 'time': '20200422161700'}]

tasker_status_num_data = [{'delivery_num': 0.0, 'id': 2, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 3, 'pick_up_num': 2.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 4, 'pick_up_num': 2.0, 'time': '20200422162000'}, {'delivery_num': 3.0, 'id': 7, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 8, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 10, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 11, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 15, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 16, 'pick_up_num': 2.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 17, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 18, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 19, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 20, 'pick_up_num': 3.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 21, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 22, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 3.0, 'id': 23, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 24, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 25, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 27, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 28, 'pick_up_num': 2.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 29, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 3.0, 'id': 30, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 31, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 33, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 34, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 35, 'pick_up_num': 2.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 36, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 37, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 38, 'pick_up_num': 2.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 39, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 40, 'pick_up_num': 2.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 41, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 42, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 43, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 44, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 146, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 160, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 161, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 162, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 163, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 167, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 168, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 178, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 181, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 182, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 188, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 193, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 195, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 213, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 2.0, 'id': 216, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 217, 'pick_up_num': 2.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 220, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 231, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 278, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 282, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 283, 'pick_up_num': 1.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 312, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 329, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 1.0, 'id': 339, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 343, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 353, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 355, 'pick_up_num': 0.0, 'time': '20200422162000'}, {'delivery_num': 0.0, 'id': 356, 'pick_up_num': 0.0, 'time': '20200422162000'}]

brand_busy_index_data = [{0: '0', 'id': 2, 'time': '20200422162300', 'brand': {'0': {'extra_require_biker': 5.0, 'extra_require_walker': 0.0, 'extra_require_van': 5.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000527': 3}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {'100000527': 1}}, '40': {'extra_require_biker': 5.0, 'extra_require_walker': 0.0, 'extra_require_van': 5.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100001739': 1}, 'pickup_order': {'100001739': 4, '100001741': 1}, 'pickup_biker': {'100001739': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '40', 'id': 2, 'time': '20200422162300', 'brand': {'0': {'extra_require_biker': 5.0, 'extra_require_walker': 0.0, 'extra_require_van': 5.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000527': 3}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {'100000527': 1}}, '40': {'extra_require_biker': 5.0, 'extra_require_walker': 0.0, 'extra_require_van': 5.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100001739': 1}, 'pickup_order': {'100001739': 4, '100001741': 1}, 'pickup_biker': {'100001739': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 3, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000002': 2}, 'pickup_order': {'100000000': 2, '100000036': 1}, 'pickup_biker': {'100000000': 1, '100000036': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 4, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000006': 2}, 'pickup_biker': {'100000006': 2}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 7, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 2.0, 'extra_require_walker': 0.0, 'extra_require_van': 2.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000021': 1, '100000416': 2}, 'pickup_order': {'100000024': 1}, 'pickup_biker': {'100000024': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 8, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 2.0, 'extra_require_walker': 0.0, 'extra_require_van': 2.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000028': 2, '100000403': 1}, 'pickup_order': {'100000118': 1, '100000404': 2}, 'pickup_biker': {'100000118': 1, '100000404': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '4', 'id': 10, 'time': '20200422162300', 'brand': {'4': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000504': 1}, 'pickup_biker': {'100000504': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 11, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000040': 1}, 'pickup_order': {'100000004': 1, '100000040': 1}, 'pickup_biker': {'100000040': 1}, 'pickup_walker': {'100000004': 1}, 'pickup_van': {}}}}, {0: '1', 'id': 15, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000049': 1}, 'pickup_biker': {'100000049': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 16, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000045': 1, '100000048': 2}, 'pickup_biker': {'100000045': 1, '100000048': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 20, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000406': 1}, 'pickup_order': {'100000034': 1, '100000057': 9}, 'pickup_biker': {'100000034': 1, '100000057': 3}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 21, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000067': 1}, 'pickup_biker': {}, 'pickup_walker': {'100000067': 1}, 'pickup_van': {}}, '28': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100001522': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '28', 'id': 21, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000067': 1}, 'pickup_biker': {}, 'pickup_walker': {'100000067': 1}, 'pickup_van': {}}, '28': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100001522': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 22, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 2.0, 'extra_require_walker': 0.0, 'extra_require_van': 2.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000070': 1, '100000079': 2}, 'pickup_order': {'100000071': 1}, 'pickup_biker': {'100000071': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 23, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000609': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 24, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000076': 1}, 'pickup_biker': {'100000076': 1}, 'pickup_walker': {}, 'pickup_van': {}}, '4': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000174': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '4', 'id': 24, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000076': 1}, 'pickup_biker': {'100000076': 1}, 'pickup_walker': {}, 'pickup_van': {}}, '4': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000174': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 28, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000092': 1}, 'pickup_biker': {'100000092': 1}, 'pickup_walker': {}, 'pickup_van': {}}, '8': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000683': 1}, 'pickup_biker': {'100000683': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '8', 'id': 28, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000092': 1}, 'pickup_biker': {'100000092': 1}, 'pickup_walker': {}, 'pickup_van': {}}, '8': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000683': 1}, 'pickup_biker': {'100000683': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 29, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000105': 1}, 'pickup_biker': {'100000105': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 30, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 2.0, 'extra_require_walker': 0.0, 'extra_require_van': 2.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000107': 1, '100000108': 2}, 'pickup_order': {'100000106': 2}, 'pickup_biker': {'100000106': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 31, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000113': 2}, 'pickup_order': {'100000109': 1, '100000110': 2}, 'pickup_biker': {'100000110': 1}, 'pickup_walker': {'100000109': 1}, 'pickup_van': {}}}}, {0: '1', 'id': 33, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000125': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 34, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000126': 1}, 'pickup_biker': {'100000126': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 35, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000141': 1, '100000155': 1}, 'pickup_biker': {'100000141': 1}, 'pickup_walker': {}, 'pickup_van': {'100000155': 1}}}}, {0: '1', 'id': 36, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000143': 1}, 'pickup_order': {'100000144': 2}, 'pickup_biker': {}, 'pickup_walker': {'100000144': 1}, 'pickup_van': {}}}}, {0: '1', 'id': 37, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000177': 1, '100000178': 2}, 'pickup_biker': {'100000177': 1, '100000178': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 38, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000336': 2}, 'pickup_biker': {'100000336': 2}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 39, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000180': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 40, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000340': 2}, 'pickup_order': {'100000145': 3}, 'pickup_biker': {'100000145': 2}, 'pickup_walker': {}, 'pickup_van': {'100000145': 1}}}}, {0: '4', 'id': 41, 'time': '20200422162300', 'brand': {'4': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000486': 2}, 'pickup_biker': {'100000486': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 42, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000355': 4}, 'pickup_biker': {'100000355': 1}, 'pickup_walker': {}, 'pickup_van': {'100000355': 1}}}}, {0: '1', 'id': 146, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000416': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 151, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000070': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 160, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000028': 2}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '4', 'id': 161, 'time': '20200422162300', 'brand': {'4': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000175': 1}, 'pickup_biker': {'100000175': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 162, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000107': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 163, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000108': 2}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 167, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000113': 2}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 182, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000002': 2}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 188, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000143': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 193, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000406': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 216, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000890': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}, '4': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000485': 1}, 'pickup_biker': {'100000485': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '4', 'id': 216, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000890': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}, '4': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {}, 'pickup_order': {'100000485': 1}, 'pickup_biker': {'100000485': 1}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 217, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000407': 1}, 'pickup_order': {'100000407': 1, '100000408': 1}, 'pickup_biker': {'100000407': 1, '100000408': 1}, 'pickup_walker': {}, 'pickup_van': {}}, '4': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000482': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '4', 'id': 217, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 0.0, 'extra_require_walker': 0.0, 'extra_require_van': 0.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000407': 1}, 'pickup_order': {'100000407': 1, '100000408': 1}, 'pickup_biker': {'100000407': 1, '100000408': 1}, 'pickup_walker': {}, 'pickup_van': {}}, '4': {'extra_require_biker': 1.0, 'extra_require_walker': 0.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000482': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 282, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000403': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 283, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000079': 2}, 'pickup_order': {'100000079': 2}, 'pickup_biker': {}, 'pickup_walker': {'100000079': 1}, 'pickup_van': {}}}}, {0: '1', 'id': 329, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000125': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 339, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000407': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '4', 'id': 340, 'time': '20200422162300', 'brand': {'4': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000482': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}, {0: '1', 'id': 343, 'time': '20200422162300', 'brand': {'1': {'extra_require_biker': 1.0, 'extra_require_walker': 1.0, 'extra_require_van': 1.0, 'brand_free_tasker_num': 0.0, 'distribute_order': {'100000609': 1}, 'pickup_order': {}, 'pickup_biker': {}, 'pickup_walker': {}, 'pickup_van': {}}}}]

working_tasker_num_data = [{0: '8', 'id': 21, 'time': '20200422135800', 'brand': {'8': {'brand_pickup_tasker_num': 1, 'brand_delivery_tasker_num': 0, 'brand_schedule_free_tasker_num': 1}}, 'non_brand_schedule_pickup_num': 0.0, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0},
                           {0: '8', 'id': 21, 'time': '20200422135700', 'brand': {'8': {'brand_pickup_tasker_num': 1, 'brand_delivery_tasker_num': 0, 'brand_schedule_free_tasker_num': 1}}, 'non_brand_schedule_pickup_num': 0.0, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0},
                           {0: '8', 'id': 21, 'time': '20200422135400', 'brand': {'8': {'brand_pickup_tasker_num': 0, 'brand_delivery_tasker_num': 1}}, 'non_brand_schedule_pickup_num': 0.0, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0},
                            ]
area_distribute_index_data = [{0: '2020042200042158', 'id': 3, 'time': '20200422163500', 'distribute_index': {'2020042200042158': 30.0, '2020042246666425': 925.0, '2020042227363581': 1178.0}}, {0: '2020042246666425', 'id': 3, 'time': '20200422163500', 'distribute_index': {'2020042200042158': 30.0, '2020042246666425': 925.0, '2020042227363581': 1178.0}}, {0: '2020042227363581', 'id': 3, 'time': '20200422163500', 'distribute_index': {'2020042200042158': 30.0, '2020042246666425': 925.0, '2020042227363581': 1178.0}}, {0: '2020042247187502', 'id': 7, 'time': '20200422163500', 'distribute_index': {'2020042247187502': 11.0, '2020042238316194': 365.0, '2020042238075834': 650.0, '2020042237891619': 936.0, '2020042276799284': 964.0}}, {0: '2020042238316194', 'id': 7, 'time': '20200422163500', 'distribute_index': {'2020042247187502': 11.0, '2020042238316194': 365.0, '2020042238075834': 650.0, '2020042237891619': 936.0, '2020042276799284': 964.0}}, {0: '2020042238075834', 'id': 7, 'time': '20200422163500', 'distribute_index': {'2020042247187502': 11.0, '2020042238316194': 365.0, '2020042238075834': 650.0, '2020042237891619': 936.0, '2020042276799284': 964.0}}, {0: '2020042237891619', 'id': 7, 'time': '20200422163500', 'distribute_index': {'2020042247187502': 11.0, '2020042238316194': 365.0, '2020042238075834': 650.0, '2020042237891619': 936.0, '2020042276799284': 964.0}}, {0: '2020042276799284', 'id': 7, 'time': '20200422163500', 'distribute_index': {'2020042247187502': 11.0, '2020042238316194': 365.0, '2020042238075834': 650.0, '2020042237891619': 936.0, '2020042276799284': 964.0}}, {0: '2020042295205979', 'id': 8, 'time': '20200422163500', 'distribute_index': {'2020042295205979': 356.0, '2020042237418770': 375.0, '2020042271515233': 1720.0}}, {0: '2020042237418770', 'id': 8, 'time': '20200422163500', 'distribute_index': {'2020042295205979': 356.0, '2020042237418770': 375.0, '2020042271515233': 1720.0}}, {0: '2020042271515233', 'id': 8, 'time': '20200422163500', 'distribute_index': {'2020042295205979': 356.0, '2020042237418770': 375.0, '2020042271515233': 1720.0}}, {0: '2020042201558416', 'id': 11, 'time': '20200422163500', 'distribute_index': {'2020042201558416': 346.0}}, {0: '2020042254350375', 'id': 20, 'time': '20200422163500', 'distribute_index': {'2020042254350375': 606.0}}, {0: '2020042272014304', 'id': 22, 'time': '20200422163500', 'distribute_index': {'2020042272014304': 79.0, '2020042284804075': 348.0, '2020042261343718': 778.0, '2020042207565646': 906.0}}, {0: '2020042284804075', 'id': 22, 'time': '20200422163500', 'distribute_index': {'2020042272014304': 79.0, '2020042284804075': 348.0, '2020042261343718': 778.0, '2020042207565646': 906.0}}, {0: '2020042261343718', 'id': 22, 'time': '20200422163500', 'distribute_index': {'2020042272014304': 79.0, '2020042284804075': 348.0, '2020042261343718': 778.0, '2020042207565646': 906.0}}, {0: '2020042207565646', 'id': 22, 'time': '20200422163500', 'distribute_index': {'2020042272014304': 79.0, '2020042284804075': 348.0, '2020042261343718': 778.0, '2020042207565646': 906.0}}, {0: '2020042209927907', 'id': 23, 'time': '20200422163500', 'distribute_index': {'2020042209927907': 65.0, '2020042243964410': 71.0, '2020042298760202': 81.0}}, {0: '2020042243964410', 'id': 23, 'time': '20200422163500', 'distribute_index': {'2020042209927907': 65.0, '2020042243964410': 71.0, '2020042298760202': 81.0}}, {0: '2020042298760202', 'id': 23, 'time': '20200422163500', 'distribute_index': {'2020042209927907': 65.0, '2020042243964410': 71.0, '2020042298760202': 81.0}}, {0: '2020042251576531', 'id': 24, 'time': '20200422163500', 'distribute_index': {'2020042251576531': 511.0, '2020042206248952': 2382.0}}, {0: '2020042206248952', 'id': 24, 'time': '20200422163500', 'distribute_index': {'2020042251576531': 511.0, '2020042206248952': 2382.0}}, {0: '2020042246422250', 'id': 27, 'time': '20200422163500', 'distribute_index': {'2020042246422250': 78.0}}, {0: '2020042277632749', 'id': 30, 'time': '20200422163500', 'distribute_index': {'2020042277632749': 718.0, '2020042241995584': 1021.0}}, {0: '2020042241995584', 'id': 30, 'time': '20200422163500', 'distribute_index': {'2020042277632749': 718.0, '2020042241995584': 1021.0}}, {0: '2020042295294664', 'id': 31, 'time': '20200422163500', 'distribute_index': {'2020042295294664': 180.0}}, {0: '2020042212736893', 'id': 33, 'time': '20200422163500', 'distribute_index': {'2020042212736893': 5.0, '2020042281376469': 1722.0}}, {0: '2020042281376469', 'id': 33, 'time': '20200422163500', 'distribute_index': {'2020042212736893': 5.0, '2020042281376469': 1722.0}}, {0: '2020042243984316', 'id': 36, 'time': '20200422163500', 'distribute_index': {'2020042243984316': 1210.0}}, {0: '2020042200900974', 'id': 38, 'time': '20200422163500', 'distribute_index': {'2020042200900974': 8.0, '2020042218360844': 69.0, '2020042244290373': 221.0}}, {0: '2020042218360844', 'id': 38, 'time': '20200422163500', 'distribute_index': {'2020042200900974': 8.0, '2020042218360844': 69.0, '2020042244290373': 221.0}}, {0: '2020042244290373', 'id': 38, 'time': '20200422163500', 'distribute_index': {'2020042200900974': 8.0, '2020042218360844': 69.0, '2020042244290373': 221.0}}, {0: '2020042267443909', 'id': 39, 'time': '20200422163500', 'distribute_index': {'2020042267443909': 1163.0}}, {0: '2020042238075834', 'id': 146, 'time': '20200422163500', 'distribute_index': {'2020042238075834': 650.0, '2020042237891619': 936.0}}, {0: '2020042237891619', 'id': 146, 'time': '20200422163500', 'distribute_index': {'2020042238075834': 650.0, '2020042237891619': 936.0}}, {0: '2020042200042158', 'id': 149, 'time': '20200422163500', 'distribute_index': {'2020042200042158': 30.0}}, {0: '2020042261343718', 'id': 151, 'time': '20200422163500', 'distribute_index': {'2020042261343718': 778.0}}, {0: '2020042295205979', 'id': 160, 'time': '20200422163500', 'distribute_index': {'2020042295205979': 356.0}}, {0: '2020042274764252', 'id': 161, 'time': '20200422163500', 'distribute_index': {'2020042274764252': 42.0}}, {0: '2020042277632749', 'id': 163, 'time': '20200422163500', 'distribute_index': {'2020042277632749': 718.0, '2020042241995584': 1021.0}}, {0: '2020042241995584', 'id': 163, 'time': '20200422163500', 'distribute_index': {'2020042277632749': 718.0, '2020042241995584': 1021.0}}, {0: '2020042246666425', 'id': 182, 'time': '20200422163500', 'distribute_index': {'2020042246666425': 925.0, '2020042227363581': 1178.0}}, {0: '2020042227363581', 'id': 182, 'time': '20200422163500', 'distribute_index': {'2020042246666425': 925.0, '2020042227363581': 1178.0}}, {0: '2020042243984316', 'id': 188, 'time': '20200422163500', 'distribute_index': {'2020042243984316': 1210.0}}, {0: '2020042284804075', 'id': 191, 'time': '20200422163500', 'distribute_index': {'2020042284804075': 348.0}}, {0: '2020042254350375', 'id': 193, 'time': '20200422163500', 'distribute_index': {'2020042254350375': 606.0}}, {0: '2020042201558416', 'id': 198, 'time': '20200422163500', 'distribute_index': {'2020042201558416': 346.0}}, {0: '2020042272014304', 'id': 213, 'time': '20200422163500', 'distribute_index': {'2020042272014304': 79.0}}, {0: '2020042243964410', 'id': 215, 'time': '20200422163500', 'distribute_index': {'2020042243964410': 71.0, '2020042298760202': 81.0}}, {0: '2020042298760202', 'id': 215, 'time': '20200422163500', 'distribute_index': {'2020042243964410': 71.0, '2020042298760202': 81.0}}, {0: '2020042294093568', 'id': 217, 'time': '20200422163500', 'distribute_index': {'2020042294093568': 201.0, '2020042254982946': 403.0}}, {0: '2020042254982946', 'id': 217, 'time': '20200422163500', 'distribute_index': {'2020042294093568': 201.0, '2020042254982946': 403.0}}, {0: '2020042271515233', 'id': 282, 'time': '20200422163500', 'distribute_index': {'2020042271515233': 1720.0}}, {0: '2020042295294664', 'id': 328, 'time': '20200422163500', 'distribute_index': {'2020042295294664': 180.0}}, {0: '2020042281376469', 'id': 329, 'time': '20200422163500', 'distribute_index': {'2020042281376469': 1722.0}}, {0: '2020042294093568', 'id': 340, 'time': '20200422163500', 'distribute_index': {'2020042294093568': 201.0}}]

not_brand_working_tasker_num_data = [{'id': 0, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 4.0, 'time': '20200422163100'}, {'id': 2, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 2.0, 'time': '20200422163100'}, {'id': 3, 'non_brand_schedule_delivery_num': 3.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 4, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 2.0, 'time': '20200422163100'}, {'id': 7, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 8, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 10, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 11, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 15, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 2.0, 'non_brand_schedule_pickup_num': 2.0, 'time': '20200422163100'}, {'id': 16, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 17, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 1.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 18, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 3.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 19, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 1.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 20, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 3.0, 'time': '20200422163100'}, {'id': 21, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 22, 'non_brand_schedule_delivery_num': 3.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 23, 'non_brand_schedule_delivery_num': 3.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 24, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 25, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 1.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 27, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 28, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 29, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 1.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 30, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 2.0, 'time': '20200422163100'}, {'id': 31, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 33, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 34, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 35, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 1.0, 'non_brand_schedule_pickup_num': 2.0, 'time': '20200422163100'}, {'id': 36, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 37, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 38, 'non_brand_schedule_delivery_num': 3.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 39, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 40, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 3.0, 'time': '20200422163100'}, {'id': 41, 'non_brand_schedule_delivery_num': 1.0, 'non_brand_schedule_free_tasker_num': 1.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 42, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 43, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 2.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 44, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 1.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 161, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 1.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 216, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 2.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 217, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 220, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 3.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 278, 'non_brand_schedule_delivery_num': 2.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}, {'id': 283, 'non_brand_schedule_delivery_num': 4.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 312, 'non_brand_schedule_delivery_num': 0.0, 'non_brand_schedule_free_tasker_num': 2.0, 'non_brand_schedule_pickup_num': 0.0, 'time': '20200422163100'}, {'id': 339, 'non_brand_schedule_delivery_num': 3.0, 'non_brand_schedule_free_tasker_num': 0.0, 'non_brand_schedule_pickup_num': 1.0, 'time': '20200422163100'}]

user_info_data = [{'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000000, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000002, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000006, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000018, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000021, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000024, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 1, 'id': 100000028, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000034, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000039, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000040, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000042, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 1, 'id': 100000044, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000045, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000049, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000057, 'pickup_order_num': 4, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000070, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 2, 'id': 100000071, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000072, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000073, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 2, 'id': 100000077, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000079, 'pickup_order_num': 4, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000087, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000090, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000091, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000105, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000106, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000107, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 2, 'id': 100000108, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000109, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000111, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000113, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000120, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000125, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000141, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000142, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 2, 'distribute_order_num': 0, 'id': 100000143, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 2, 'distribute_order_num': 1, 'id': 100000145, 'pickup_order_num': 3, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000151, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000174, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000175, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000180, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000336, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 3, 'id': 100000337, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000340, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000355, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000389, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000403, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 1, 'id': 100000406, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 0, 'id': 100000407, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 4, 'id': 100000416, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000481, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000482, 'pickup_order_num': 2, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000504, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 0, 'id': 100000527, 'pickup_order_num': 3, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100000609, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 1, 'id': 100000974, 'pickup_order_num': 0, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100001522, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100001577, 'pickup_order_num': 1, 'time': '20200422163900'}, {'below_preset_tasker': 0, 'distribute_order_num': 0, 'id': 100001739, 'pickup_order_num': 5, 'time': '20200422163900'}, {'below_preset_tasker': 1, 'distribute_order_num': 0, 'id': 100001741, 'pickup_order_num': 1, 'time': '20200422163900'}]

tasker_order_status_data = [{'area_id': 0, 'id': 1389, 'last_2hour_delay_finish_time': 0.0, 'last_2hour_push_time': 0.0, 'last_week_delay_finish_time': 0.0, 'last_week_push_time': 0.0, 'tasker_status': 1, 'time': '20200422164100'},
                            {'area_id': 216, 'id': 1667, 'last_2hour_delay_finish_time': 6.43, 'last_2hour_push_time': 2.0, 'last_week_delay_finish_time': 0.0, 'last_week_push_time': 0.0, 'tasker_status': 3, 'time': '20200422164100'},
                            {'area_id': 0, 'id': 1719, 'last_2hour_delay_finish_time': 0.0, 'last_2hour_push_time': 0.0, 'last_week_delay_finish_time': 0.0, 'last_week_push_time': 0.0, 'tasker_status': 1, 'time': '20200422164100'}, ]

class CollectTest(unittest.TestCase):
    def test_collect_timelines(self):
        data = collect_timelines(pd.DataFrame(order_timelines_data))
        self.assertEqual(data.to_dict(), pd.DataFrame({'accept': {0: 0.07, 1: 4.0, 2: 13.7}, 'delivery': {0: 22.93, 1: 11.15, 2: 10.53}, 'showup': {0: 2.1, 1: 7.73, 2: 12.75}, 'quote': {0: 24.65, 1: 27.45, 2: 37.67}, 'work': {0: 24.57, 1: 23.45, 2: 23.97}, 'area_id': {0: 31, 1: 10, 2: 36}, 'child_area_id': {0: 0, 1: 0, 2: 187}, 'default_service_type': {0: 2, 1: 2, 2: 2}, 'deviation_delivery': {0: 24.38, 1: 15.35, 2: 11.9}, 'id': {0: 2020042271242260, 1: 2020042275639687, 2: 2020042268286952}, 'position_type_id': {0: 2, 1: 2, 2: 10}, 'region': {0: 'HK', 1: 'HK', 2: 'HK'}, 'deviation_showup': {0: 0.95, 1: 4.65, 2: 12.82}, 'showup_bluetooth': {0: 0.0, 1: 0.0, 2: 0.0}, 'showup_gps': {0: 0.95, 1: 4.65, 2: 12.82}, 'showup_manual': {0: 0.0, 1: 0.0, 2: 0.0}, 'tasker_id': {0: 852000828, 1: 8970, 2: 852003658}, 'time': {0: '20200422141714', 1: '20200422141713', 2: '20200422141632'}, 'deviation_quote': {0: 26.1, 1: 31.65, 2: 39.03}, 'user_id': {0: 100000109, 1: 100000037, 2: 100000142}, 'deviation_work': {0: 26.03, 1: 27.65, 2: 25.33}, 'order_time': {0: arrow.get("2020-04-22T14:17:14+08:00"), 1: arrow.get("2020-04-22T14:17:13+08:00"), 2: arrow.get("2020-04-22T14:16:32+08:00")}, 'time1': {0: '20200422141700', 1: '20200422141700', 2: '20200422141600'}, 'time60': {0: '20200422140000', 1: '20200422140000', 2: '20200422140000'}, 'weekday': {0: 3, 1: 3, 2: 3}, 'hour': {0: 14, 1: 14, 2: 14}, 'weekend?': {0: False, 1: False, 2: False}}).to_dict())

        data = collect_timelines(pd.DataFrame())
        self.assertEqual(data.to_dict(), {})

    def test_collect_accept_tasker_coor(self):
        data = collect_accept_tasker_coor(pd.DataFrame(tasker_realtime_info_data))
        self.assertEqual(data.to_dict(),
                         pd.DataFrame({'accuracy': {0: 37.25, 1: 14.82, 2: 12.13}, 'id': {0: 100002055, 1: 100002080, 2: 100002114}, 'tasker_latitude': {0: 22.4134731293, 1: 22.3253326416, 2: 22.3625488281}, 'tasker_longitude': {0: 113.9826812744, 1: 114.1585388184, 2: 114.172164917}, 'time': {0: '20200422140800', 1: '20200422140800', 2: '20200422140800'}}).to_dict())

        data = collect_accept_tasker_coor(pd.DataFrame())
        self.assertEqual(data.to_dict(), {})

    def test_collect_tasker_order_count(self):
        data = collect_tasker_order_count(pd.DataFrame(tasker_order_num_data), pd.DataFrame(order_405_data))
        self.assertEqual(data.to_dict(), pd.DataFrame({'id': {0: 2020042281436137, 1: 2020042219548702, 2: 2020042211067393, 3: 2020042221255978, 4: 2020042210701216, 5: 2020042261111336}, 'order_405_time': {0: 1587543095, 1: 1587543033, 2: 1587543552, 3: 1587543323, 4: 1587543817, 5: 1587543903}, 'tasker_order_count': {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1}}).to_dict())

        data = collect_tasker_order_count(pd.DataFrame(), pd.DataFrame())
        self.assertEqual(data.to_dict(), {'tasker_order_count': {}})

    def test_collect_area_busy_index(self):
        data = collect_area_busy_index(pd.DataFrame(area_busy_index_data))
        self.assertEqual(data.to_dict(), pd.DataFrame({'extra_require_biker': {0: 5, 1: 2, 2: 0, 3: 2, 4: 3, 5: 1, 6: 1, 7: 1, 8: 0, 9: 0, 10: 3, 11: 2, 12: 3, 13: 0, 14: 0, 15: 0, 16: 1, 17: 1, 18: 0, 19: 1, 20: 1, 21: 0, 22: 1, 23: 1, 24: 0, 25: 0, 26: 1, 27: 0, 28: 0, 29: 0, 30: 1, 31: 1, 32: 1, 33: 1, 34: 1, 35: 1, 36: 1, 37: 1, 38: 1, 39: 1, 40: 1, 41: 1, 42: 1, 43: 1, 44: 1, 45: 1, 46: 2, 47: 0, 48: 1, 49: 0, 50: 1, 51: 2, 52: 1, 53: 1, 54: 1}, 'extra_require_walker': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 1, 31: 1, 32: 1, 33: 1, 34: 0, 35: 1, 36: 1, 37: 1, 38: 1, 39: 1, 40: 1, 41: 1, 42: 1, 43: 1, 44: 1, 45: 1, 46: 0, 47: 0, 48: 1, 49: 0, 50: 1, 51: 2, 52: 1, 53: 1, 54: 1}, 'area_id': {0: 2, 1: 3, 2: 4, 3: 7, 4: 8, 5: 10, 6: 11, 7: 16, 8: 17, 9: 18, 10: 20, 11: 21, 12: 22, 13: 23, 14: 24, 15: 27, 16: 28, 17: 29, 18: 30, 19: 31, 20: 33, 21: 34, 22: 35, 23: 36, 24: 37, 25: 38, 26: 39, 27: 40, 28: 41, 29: 42, 30: 146, 31: 149, 32: 159, 33: 160, 34: 161, 35: 167, 36: 168, 37: 178, 38: 183, 39: 188, 40: 191, 41: 193, 42: 194, 43: 195, 44: 206, 45: 213, 46: 216, 47: 217, 48: 231, 49: 278, 50: 282, 51: 283, 52: 310, 53: 329, 54: 339}, 'next_minute': {0: '20200422161700', 1: '20200422161700', 2: '20200422161700', 3: '20200422161700', 4: '20200422161700', 5: '20200422161700', 6: '20200422161700', 7: '20200422161700', 8: '20200422161700', 9: '20200422161700', 10: '20200422161700', 11: '20200422161700', 12: '20200422161700', 13: '20200422161700', 14: '20200422161700', 15: '20200422161700', 16: '20200422161700', 17: '20200422161700', 18: '20200422161700', 19: '20200422161700', 20: '20200422161700', 21: '20200422161700', 22: '20200422161700', 23: '20200422161700', 24: '20200422161700', 25: '20200422161700', 26: '20200422161700', 27: '20200422161700', 28: '20200422161700', 29: '20200422161700', 30: '20200422161700', 31: '20200422161700', 32: '20200422161700', 33: '20200422161700', 34: '20200422161700', 35: '20200422161700', 36: '20200422161700', 37: '20200422161700', 38: '20200422161700', 39: '20200422161700', 40: '20200422161700', 41: '20200422161700', 42: '20200422161700', 43: '20200422161700', 44: '20200422161700', 45: '20200422161700', 46: '20200422161700', 47: '20200422161700', 48: '20200422161700', 49: '20200422161700', 50: '20200422161700', 51: '20200422161700', 52: '20200422161700', 53: '20200422161700', 54: '20200422161700'}}).to_dict())

        data = collect_area_busy_index(pd.DataFrame())
        self.assertEqual(data.to_dict(), {})

    def test_collect_tasker_status_num(self):
        data = collect_tasker_status_num(pd.DataFrame(tasker_status_num_data))
        self.assertEqual(data.to_dict(), pd.DataFrame({'delivery_num': {0: 0.0, 1: 1.0, 2: 2.0, 3: 3.0, 4: 2.0, 5: 1.0, 6: 1.0, 7: 0.0, 8: 0.0, 9: 1.0, 10: 1.0, 11: 0.0, 12: 1.0, 13: 1.0, 14: 2.0, 15: 3.0, 16: 0.0, 17: 2.0, 18: 2.0, 19: 1.0, 20: 2.0, 21: 3.0, 22: 0.0, 23: 2.0, 24: 1.0, 25: 1.0, 26: 1.0, 27: 1.0, 28: 1.0, 29: 2.0, 30: 2.0, 31: 0.0, 32: 2.0, 33: 0.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 1.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 1.0, 49: 2.0, 50: 1.0, 51: 0.0, 52: 0.0, 53: 1.0, 54: 0.0, 55: 0.0, 56: 1.0, 57: 0.0, 58: 1.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0}, 'area_id': {0: 2, 1: 3, 2: 4, 3: 7, 4: 8, 5: 10, 6: 11, 7: 15, 8: 16, 9: 17, 10: 18, 11: 19, 12: 20, 13: 21, 14: 22, 15: 23, 16: 24, 17: 25, 18: 27, 19: 28, 20: 29, 21: 30, 22: 31, 23: 33, 24: 34, 25: 35, 26: 36, 27: 37, 28: 38, 29: 39, 30: 40, 31: 41, 32: 42, 33: 43, 34: 44, 35: 146, 36: 160, 37: 161, 38: 162, 39: 163, 40: 167, 41: 168, 42: 178, 43: 181, 44: 182, 45: 188, 46: 193, 47: 195, 48: 213, 49: 216, 50: 217, 51: 220, 52: 231, 53: 278, 54: 282, 55: 283, 56: 312, 57: 329, 58: 339, 59: 343, 60: 353, 61: 355, 62: 356}, 'pick_up_num': {0: 0.0, 1: 2.0, 2: 2.0, 3: 0.0, 4: 1.0, 5: 0.0, 6: 1.0, 7: 1.0, 8: 2.0, 9: 0.0, 10: 0.0, 11: 0.0, 12: 3.0, 13: 1.0, 14: 1.0, 15: 0.0, 16: 1.0, 17: 0.0, 18: 0.0, 19: 2.0, 20: 0.0, 21: 1.0, 22: 1.0, 23: 0.0, 24: 1.0, 25: 2.0, 26: 0.0, 27: 1.0, 28: 2.0, 29: 0.0, 30: 2.0, 31: 1.0, 32: 1.0, 33: 0.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 1.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 1.0, 50: 2.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 1.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0}, 'time1': {0: '20200422162000', 1: '20200422162000', 2: '20200422162000', 3: '20200422162000', 4: '20200422162000', 5: '20200422162000', 6: '20200422162000', 7: '20200422162000', 8: '20200422162000', 9: '20200422162000', 10: '20200422162000', 11: '20200422162000', 12: '20200422162000', 13: '20200422162000', 14: '20200422162000', 15: '20200422162000', 16: '20200422162000', 17: '20200422162000', 18: '20200422162000', 19: '20200422162000', 20: '20200422162000', 21: '20200422162000', 22: '20200422162000', 23: '20200422162000', 24: '20200422162000', 25: '20200422162000', 26: '20200422162000', 27: '20200422162000', 28: '20200422162000', 29: '20200422162000', 30: '20200422162000', 31: '20200422162000', 32: '20200422162000', 33: '20200422162000', 34: '20200422162000', 35: '20200422162000', 36: '20200422162000', 37: '20200422162000', 38: '20200422162000', 39: '20200422162000', 40: '20200422162000', 41: '20200422162000', 42: '20200422162000', 43: '20200422162000', 44: '20200422162000', 45: '20200422162000', 46: '20200422162000', 47: '20200422162000', 48: '20200422162000', 49: '20200422162000', 50: '20200422162000', 51: '20200422162000', 52: '20200422162000', 53: '20200422162000', 54: '20200422162000', 55: '20200422162000', 56: '20200422162000', 57: '20200422162000', 58: '20200422162000', 59: '20200422162000', 60: '20200422162000', 61: '20200422162000', 62: '20200422162000'}}).to_dict())

        data = collect_tasker_status_num(pd.DataFrame())
        self.assertEqual(data.to_dict(), {})

    def test_collect_brand_busy_index(self):
        data = collect_brand_busy_index(pd.DataFrame(brand_busy_index_data))
        self.assertEqual(data.to_dict(), pd.DataFrame({'area_id': {0: 2, 1: 2, 2: 3, 3: 4, 4: 7, 5: 8, 6: 10, 7: 11, 8: 15, 9: 16, 10: 20, 11: 21, 12: 21, 13: 22, 14: 23, 15: 24, 16: 24, 17: 28, 18: 28, 19: 29, 20: 30, 21: 31, 22: 33, 23: 34, 24: 35, 25: 36, 26: 37, 27: 38, 28: 39, 29: 40, 30: 41, 31: 42, 32: 146, 33: 151, 34: 160, 35: 161, 36: 162, 37: 163, 38: 167, 39: 182, 40: 188, 41: 193, 42: 216, 43: 216, 44: 217, 45: 217, 46: 282, 47: 283, 48: 329, 49: 339, 50: 340, 51: 343}, 'next_minute': {0: '20200422162300', 1: '20200422162300', 2: '20200422162300', 3: '20200422162300', 4: '20200422162300', 5: '20200422162300', 6: '20200422162300', 7: '20200422162300', 8: '20200422162300', 9: '20200422162300', 10: '20200422162300', 11: '20200422162300', 12: '20200422162300', 13: '20200422162300', 14: '20200422162300', 15: '20200422162300', 16: '20200422162300', 17: '20200422162300', 18: '20200422162300', 19: '20200422162300', 20: '20200422162300', 21: '20200422162300', 22: '20200422162300', 23: '20200422162300', 24: '20200422162300', 25: '20200422162300', 26: '20200422162300', 27: '20200422162300', 28: '20200422162300', 29: '20200422162300', 30: '20200422162300', 31: '20200422162300', 32: '20200422162300', 33: '20200422162300', 34: '20200422162300', 35: '20200422162300', 36: '20200422162300', 37: '20200422162300', 38: '20200422162300', 39: '20200422162300', 40: '20200422162300', 41: '20200422162300', 42: '20200422162300', 43: '20200422162300', 44: '20200422162300', 45: '20200422162300', 46: '20200422162300', 47: '20200422162300', 48: '20200422162300', 49: '20200422162300', 50: '20200422162300', 51: '20200422162300'}, 'brand_id': {0: 0.0, 1: 40.0, 2: 1.0, 3: 1.0, 4: 1.0, 5: 1.0, 6: 4.0, 7: 1.0, 8: 1.0, 9: 1.0, 10: 1.0, 11: 1.0, 12: 28.0, 13: 1.0, 14: 1.0, 15: 1.0, 16: 4.0, 17: 1.0, 18: 8.0, 19: 1.0, 20: 1.0, 21: 1.0, 22: 1.0, 23: 1.0, 24: 1.0, 25: 1.0, 26: 1.0, 27: 1.0, 28: 1.0, 29: 1.0, 30: 4.0, 31: 1.0, 32: 1.0, 33: 1.0, 34: 1.0, 35: 4.0, 36: 1.0, 37: 1.0, 38: 1.0, 39: 1.0, 40: 1.0, 41: 1.0, 42: 1.0, 43: 4.0, 44: 1.0, 45: 4.0, 46: 1.0, 47: 1.0, 48: 1.0, 49: 1.0, 50: 4.0, 51: 1.0}, 'extra_require_biker': {0: 5.0, 1: 5.0, 2: 1.0, 3: 0.0, 4: 2.0, 5: 2.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 1.0, 11: 0.0, 12: 1.0, 13: 2.0, 14: 1.0, 15: 0.0, 16: 1.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 2.0, 21: 1.0, 22: 1.0, 23: 0.0, 24: 0.0, 25: 1.0, 26: 0.0, 27: 0.0, 28: 1.0, 29: 1.0, 30: 0.0, 31: 0.0, 32: 1.0, 33: 1.0, 34: 1.0, 35: 0.0, 36: 1.0, 37: 1.0, 38: 1.0, 39: 1.0, 40: 1.0, 41: 1.0, 42: 1.0, 43: 0.0, 44: 0.0, 45: 1.0, 46: 1.0, 47: 1.0, 48: 1.0, 49: 1.0, 50: 1.0, 51: 1.0}}).to_dict())

        data = collect_brand_busy_index(pd.DataFrame())
        self.assertEqual(data.to_dict(), {})

    def test_collect_working_tasker_num(self):
        data = collect_working_tasker_num(pd.DataFrame(working_tasker_num_data))
        self.assertEqual(data.to_dict(), pd.DataFrame({'brand_id': {0: 8.0, 1: 8.0, 2: 8.0}, 'area_id': {0: 21, 1: 21, 2: 21}, 'next_minute': {0: '20200422135800', 1: '20200422135700', 2: '20200422135400'}, 'brand_delivery_tasker_num': {0: 0, 1: 0, 2: 1}, 'brand_pickup_tasker_num': {0: 1, 1: 1, 2: 0}, 'brand_schedule_free_tasker_num': {0: 1, 1: 1, 2: 0}}).to_dict())

        data = collect_working_tasker_num(pd.DataFrame())
        self.assertEqual(data.to_dict(), {})

    def test_collect_not_brand_working_tasker_num(self):
        data = collect_not_brand_working_tasker_num(pd.DataFrame(not_brand_working_tasker_num_data))
        self.assertEqual(data.to_dict(), pd.DataFrame({'area_id': {0: 0, 1: 2, 2: 3, 3: 4, 4: 7, 5: 8, 6: 10, 7: 11, 8: 15, 9: 16, 10: 17, 11: 18, 12: 19, 13: 20, 14: 21, 15: 22, 16: 23, 17: 24, 18: 25, 19: 27, 20: 28, 21: 29, 22: 30, 23: 31, 24: 33, 25: 34, 26: 35, 27: 36, 28: 37, 29: 38, 30: 39, 31: 40, 32: 41, 33: 42, 34: 43, 35: 44, 36: 161, 37: 216, 38: 217, 39: 220, 40: 278, 41: 283, 42: 312, 43: 339}, 'non_brand_schedule_delivery_num': {0: 1.0, 1: 0.0, 2: 3.0, 3: 1.0, 4: 1.0, 5: 1.0, 6: 1.0, 7: 1.0, 8: 0.0, 9: 1.0, 10: 1.0, 11: 0.0, 12: 1.0, 13: 2.0, 14: 2.0, 15: 3.0, 16: 3.0, 17: 1.0, 18: 2.0, 19: 2.0, 20: 1.0, 21: 1.0, 22: 2.0, 23: 0.0, 24: 2.0, 25: 1.0, 26: 0.0, 27: 1.0, 28: 2.0, 29: 3.0, 30: 1.0, 31: 1.0, 32: 1.0, 33: 2.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 2.0, 38: 2.0, 39: 0.0, 40: 2.0, 41: 4.0, 42: 0.0, 43: 3.0}, 'non_brand_schedule_free_tasker_num': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 2.0, 9: 0.0, 10: 1.0, 11: 3.0, 12: 1.0, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 1.0, 19: 0.0, 20: 0.0, 21: 1.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 1.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 1.0, 33: 0.0, 34: 2.0, 35: 1.0, 36: 1.0, 37: 2.0, 38: 0.0, 39: 3.0, 40: 0.0, 41: 0.0, 42: 2.0, 43: 0.0}, 'non_brand_schedule_pickup_num': {0: 4.0, 1: 2.0, 2: 0.0, 3: 2.0, 4: 1.0, 5: 1.0, 6: 1.0, 7: 1.0, 8: 2.0, 9: 1.0, 10: 1.0, 11: 0.0, 12: 0.0, 13: 3.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 1.0, 18: 0.0, 19: 0.0, 20: 1.0, 21: 1.0, 22: 2.0, 23: 1.0, 24: 0.0, 25: 1.0, 26: 2.0, 27: 0.0, 28: 0.0, 29: 1.0, 30: 0.0, 31: 3.0, 32: 0.0, 33: 1.0, 34: 0.0, 35: 0.0, 36: 1.0, 37: 0.0, 38: 1.0, 39: 0.0, 40: 1.0, 41: 0.0, 42: 0.0, 43: 1.0}, 'next_minute': {0: '20200422163100', 1: '20200422163100', 2: '20200422163100', 3: '20200422163100', 4: '20200422163100', 5: '20200422163100', 6: '20200422163100', 7: '20200422163100', 8: '20200422163100', 9: '20200422163100', 10: '20200422163100', 11: '20200422163100', 12: '20200422163100', 13: '20200422163100', 14: '20200422163100', 15: '20200422163100', 16: '20200422163100', 17: '20200422163100', 18: '20200422163100', 19: '20200422163100', 20: '20200422163100', 21: '20200422163100', 22: '20200422163100', 23: '20200422163100', 24: '20200422163100', 25: '20200422163100', 26: '20200422163100', 27: '20200422163100', 28: '20200422163100', 29: '20200422163100', 30: '20200422163100', 31: '20200422163100', 32: '20200422163100', 33: '20200422163100', 34: '20200422163100', 35: '20200422163100', 36: '20200422163100', 37: '20200422163100', 38: '20200422163100', 39: '20200422163100', 40: '20200422163100', 41: '20200422163100', 42: '20200422163100', 43: '20200422163100'}}).to_dict())

        data = collect_not_brand_working_tasker_num(pd.DataFrame())
        self.assertEqual(data.to_dict(), {})

    def test_collect_area_distribute_index(self):
        data = collect_area_distribute_index(pd.DataFrame(area_distribute_index_data))
        self.assertEqual(data.to_dict(), pd.DataFrame({'id': {0: 2020042200042158, 1: 2020042200042158, 2: 2020042200900974, 3: 2020042201558416, 4: 2020042201558416, 5: 2020042206248952, 6: 2020042207565646, 7: 2020042209927907, 8: 2020042212736893, 9: 2020042218360844, 10: 2020042227363581, 11: 2020042227363581, 12: 2020042237418770, 13: 2020042237891619, 14: 2020042237891619, 15: 2020042238075834, 16: 2020042238075834, 17: 2020042238316194, 18: 2020042241995584, 19: 2020042241995584, 20: 2020042243964410, 21: 2020042243964410, 22: 2020042243984316, 23: 2020042243984316, 24: 2020042244290373, 25: 2020042246422250, 26: 2020042246666425, 27: 2020042246666425, 28: 2020042247187502, 29: 2020042251576531, 30: 2020042254350375, 31: 2020042254350375, 32: 2020042254982946, 33: 2020042261343718, 34: 2020042261343718, 35: 2020042267443909, 36: 2020042271515233, 37: 2020042271515233, 38: 2020042272014304, 39: 2020042272014304, 40: 2020042274764252, 41: 2020042276799284, 42: 2020042277632749, 43: 2020042277632749, 44: 2020042281376469, 45: 2020042281376469, 46: 2020042284804075, 47: 2020042284804075, 48: 2020042294093568, 49: 2020042294093568, 50: 2020042295205979, 51: 2020042295205979, 52: 2020042295294664, 53: 2020042295294664, 54: 2020042298760202, 55: 2020042298760202}, 'area_id': {0: 3, 1: 149, 2: 38, 3: 11, 4: 198, 5: 24, 6: 22, 7: 23, 8: 33, 9: 38, 10: 3, 11: 182, 12: 8, 13: 7, 14: 146, 15: 7, 16: 146, 17: 7, 18: 30, 19: 163, 20: 23, 21: 215, 22: 36, 23: 188, 24: 38, 25: 27, 26: 3, 27: 182, 28: 7, 29: 24, 30: 20, 31: 193, 32: 217, 33: 22, 34: 151, 35: 39, 36: 8, 37: 282, 38: 22, 39: 213, 40: 161, 41: 7, 42: 30, 43: 163, 44: 33, 45: 329, 46: 22, 47: 191, 48: 217, 49: 340, 50: 8, 51: 160, 52: 31, 53: 328, 54: 23, 55: 215}, 'distribute_sort': {0: 3, 1: 1, 2: 3, 3: 1, 4: 1, 5: 1, 6: 1, 7: 3, 8: 2, 9: 2, 10: 1, 11: 1, 12: 2, 13: 2, 14: 1, 15: 3, 16: 2, 17: 4, 18: 1, 19: 1, 20: 2, 21: 2, 22: 1, 23: 1, 24: 1, 25: 1, 26: 2, 27: 2, 28: 5, 29: 2, 30: 1, 31: 1, 32: 1, 33: 2, 34: 1, 35: 1, 36: 1, 37: 1, 38: 4, 39: 1, 40: 1, 41: 1, 42: 2, 43: 2, 44: 1, 45: 1, 46: 3, 47: 1, 48: 2, 49: 1, 50: 3, 51: 1, 52: 1, 53: 1, 54: 1, 55: 1}}).to_dict())

        data = collect_area_distribute_index(pd.DataFrame())
        self.assertEqual(data.to_dict(), {})

    def test_collecters_user_info(self):
        data = collecters_user_info(pd.DataFrame(user_info_data))
        self.assertEqual(data.to_dict(), pd.DataFrame({'below_preset_tasker': {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 0, 6: 1, 7: 1, 8: 0, 9: 1, 10: 0, 11: 1, 12: 0, 13: 1, 14: 0, 15: 0, 16: 0, 17: 1, 18: 0, 19: 1, 20: 1, 21: 1, 22: 0, 23: 0, 24: 1, 25: 1, 26: 1, 27: 0, 28: 0, 29: 0, 30: 1, 31: 1, 32: 0, 33: 1, 34: 1, 35: 2, 36: 2, 37: 0, 38: 0, 39: 1, 40: 1, 41: 1, 42: 1, 43: 1, 44: 1, 45: 1, 46: 0, 47: 1, 48: 0, 49: 0, 50: 0, 51: 1, 52: 1, 53: 0, 54: 1, 55: 0, 56: 1, 57: 1, 58: 0, 59: 1}, 'user_distribute_order_num': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 1, 6: 1, 7: 0, 8: 1, 9: 0, 10: 1, 11: 1, 12: 1, 13: 0, 14: 1, 15: 1, 16: 2, 17: 0, 18: 1, 19: 2, 20: 0, 21: 0, 22: 1, 23: 1, 24: 0, 25: 0, 26: 0, 27: 2, 28: 1, 29: 1, 30: 0, 31: 0, 32: 1, 33: 0, 34: 0, 35: 0, 36: 1, 37: 1, 38: 1, 39: 0, 40: 0, 41: 0, 42: 3, 43: 0, 44: 0, 45: 0, 46: 1, 47: 1, 48: 0, 49: 4, 50: 1, 51: 0, 52: 0, 53: 0, 54: 0, 55: 1, 56: 0, 57: 0, 58: 0, 59: 0}, 'user_id': {0: 100000000, 1: 100000002, 2: 100000006, 3: 100000018, 4: 100000021, 5: 100000024, 6: 100000028, 7: 100000034, 8: 100000039, 9: 100000040, 10: 100000042, 11: 100000044, 12: 100000045, 13: 100000049, 14: 100000057, 15: 100000070, 16: 100000071, 17: 100000072, 18: 100000073, 19: 100000077, 20: 100000079, 21: 100000087, 22: 100000090, 23: 100000091, 24: 100000105, 25: 100000106, 26: 100000107, 27: 100000108, 28: 100000109, 29: 100000111, 30: 100000113, 31: 100000120, 32: 100000125, 33: 100000141, 34: 100000142, 35: 100000143, 36: 100000145, 37: 100000151, 38: 100000174, 39: 100000175, 40: 100000180, 41: 100000336, 42: 100000337, 43: 100000340, 44: 100000355, 45: 100000389, 46: 100000403, 47: 100000406, 48: 100000407, 49: 100000416, 50: 100000481, 51: 100000482, 52: 100000504, 53: 100000527, 54: 100000609, 55: 100000974, 56: 100001522, 57: 100001577, 58: 100001739, 59: 100001741}, 'user_pickup_order_num': {0: 1, 1: 2, 2: 1, 3: 1, 4: 1, 5: 0, 6: 2, 7: 1, 8: 0, 9: 2, 10: 0, 11: 1, 12: 0, 13: 1, 14: 4, 15: 0, 16: 0, 17: 1, 18: 0, 19: 1, 20: 4, 21: 1, 22: 0, 23: 0, 24: 2, 25: 2, 26: 1, 27: 0, 28: 0, 29: 0, 30: 2, 31: 1, 32: 0, 33: 2, 34: 1, 35: 2, 36: 3, 37: 0, 38: 0, 39: 1, 40: 1, 41: 1, 42: 1, 43: 2, 44: 1, 45: 1, 46: 0, 47: 1, 48: 2, 49: 0, 50: 0, 51: 2, 52: 1, 53: 3, 54: 1, 55: 0, 56: 1, 57: 1, 58: 5, 59: 1}, 'time': {0: '20200422163900', 1: '20200422163900', 2: '20200422163900', 3: '20200422163900', 4: '20200422163900', 5: '20200422163900', 6: '20200422163900', 7: '20200422163900', 8: '20200422163900', 9: '20200422163900', 10: '20200422163900', 11: '20200422163900', 12: '20200422163900', 13: '20200422163900', 14: '20200422163900', 15: '20200422163900', 16: '20200422163900', 17: '20200422163900', 18: '20200422163900', 19: '20200422163900', 20: '20200422163900', 21: '20200422163900', 22: '20200422163900', 23: '20200422163900', 24: '20200422163900', 25: '20200422163900', 26: '20200422163900', 27: '20200422163900', 28: '20200422163900', 29: '20200422163900', 30: '20200422163900', 31: '20200422163900', 32: '20200422163900', 33: '20200422163900', 34: '20200422163900', 35: '20200422163900', 36: '20200422163900', 37: '20200422163900', 38: '20200422163900', 39: '20200422163900', 40: '20200422163900', 41: '20200422163900', 42: '20200422163900', 43: '20200422163900', 44: '20200422163900', 45: '20200422163900', 46: '20200422163900', 47: '20200422163900', 48: '20200422163900', 49: '20200422163900', 50: '20200422163900', 51: '20200422163900', 52: '20200422163900', 53: '20200422163900', 54: '20200422163900', 55: '20200422163900', 56: '20200422163900', 57: '20200422163900', 58: '20200422163900', 59: '20200422163900'}}).to_dict())

        data = collecters_user_info(pd.DataFrame())
        self.assertEqual(data.to_dict(), {})
